{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mateo\\\\Documents\\\\2025.2\\\\DESARROLLO WEB\\\\MINIPROYECTO\\\\frontend\\\\src\\\\pages\\\\Roles.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport api from \"../services/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Roles() {\n  _s();\n  const [roles, setRoles] = useState([]); // guarda la lista de roles activos\n  const [nombre, setNombre] = useState(\"\"); // guarda lo que el usuario escribe para crear uno nuevo\n  const [inactivos, setInactivos] = useState([]); // lista de roles inactivos\n\n  // Cargar roles cuando se abre la página\n  useEffect(() => {\n    cargarRoles();\n    cargarInactivos();\n  }, []);\n  async function cargarRoles() {\n    const res = await api.get(\"/roles?estado=true\");\n    setRoles(res.data);\n  }\n  async function cargarInactivos() {\n    const res = await api.get(\"/roles?estado=false\");\n    setInactivos(res.data);\n  }\n  async function crearRol() {\n    if (!nombre) {\n      alert(\"Debe escribir un nombre para el rol\");\n      return;\n    }\n\n    // Validar duplicado de nombre de rol (sin distinguir mayúsculas/minúsculas)\n    const resDuplicado = await api.get(\"/roles\");\n    const existe = resDuplicado.data.some(r => r.nombre.toLowerCase() === nombre.toLowerCase());\n    if (existe) {\n      alert(\"Ya existe un rol con ese nombre.\");\n      return;\n    }\n\n    // Validar la regla especial: máximo 2 Super Administradores\n    if (nombre.toLowerCase() === \"super administrador\") {\n      const res = await api.get(\"/roles?nombre=Super Administrador\");\n      const existentes = res.data.filter(r => r.estado === true);\n      if (existentes.length >= 2) {\n        alert(\"Ya existen 2 Super Administradores activos. No puede crear más.\");\n        return;\n      }\n    }\n    const nuevoRol = {\n      nombre: nombre,\n      estado: true,\n      createdAt: new Date().toISOString(),\n      createdBy: \"web\"\n    };\n    await api.post(\"/roles\", nuevoRol);\n    setNombre(\"\");\n    cargarRoles();\n  }\n  async function eliminarRol(rol) {\n    // eliminación lógica (estado = false)\n    await api.patch(`/roles/${rol.id}`, {\n      estado: false,\n      updatedAt: new Date().toISOString()\n    });\n    cargarRoles();\n    cargarInactivos();\n  }\n  async function reactivarRol(rol) {\n    await api.patch(`/roles/${rol.id}`, {\n      estado: true,\n      updatedAt: new Date().toISOString()\n    });\n    cargarRoles();\n    cargarInactivos();\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 20\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Gesti\\xF3n de Roles\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 20\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        placeholder: \"Nuevo rol\",\n        value: nombre,\n        onChange: e => setNombre(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: crearRol,\n        children: \"Crear Rol\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Roles Activos\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: roles.map(r => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: [r.nombre, \" \", /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => eliminarRol(r),\n          children: \"Eliminar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 13\n        }, this)]\n      }, r.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Roles Inactivos (para reactivar)\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: inactivos.map(r => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: [r.nombre, \" \", /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => reactivarRol(r),\n          children: \"Reactivar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 13\n        }, this)]\n      }, r.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n}\n_s(Roles, \"bg4PEcmX86WPdKRrMGut0YA+Dqo=\");\n_c = Roles;\nvar _c;\n$RefreshReg$(_c, \"Roles\");","map":{"version":3,"names":["React","useEffect","useState","api","jsxDEV","_jsxDEV","Roles","_s","roles","setRoles","nombre","setNombre","inactivos","setInactivos","cargarRoles","cargarInactivos","res","get","data","crearRol","alert","resDuplicado","existe","some","r","toLowerCase","existentes","filter","estado","length","nuevoRol","createdAt","Date","toISOString","createdBy","post","eliminarRol","rol","patch","id","updatedAt","reactivarRol","style","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","marginBottom","placeholder","value","onChange","e","target","onClick","map","_c","$RefreshReg$"],"sources":["C:/Users/mateo/Documents/2025.2/DESARROLLO WEB/MINIPROYECTO/frontend/src/pages/Roles.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport api from \"../services/api\";\r\n\r\nexport default function Roles() {\r\n  const [roles, setRoles] = useState([]);      // guarda la lista de roles activos\r\n  const [nombre, setNombre] = useState(\"\");    // guarda lo que el usuario escribe para crear uno nuevo\r\n  const [inactivos, setInactivos] = useState([]); // lista de roles inactivos\r\n\r\n  // Cargar roles cuando se abre la página\r\n  useEffect(() => {\r\n    cargarRoles();\r\n    cargarInactivos();\r\n  }, []);\r\n\r\n  async function cargarRoles() {\r\n    const res = await api.get(\"/roles?estado=true\");\r\n    setRoles(res.data);\r\n  }\r\n\r\n  async function cargarInactivos() {\r\n    const res = await api.get(\"/roles?estado=false\");\r\n    setInactivos(res.data);\r\n  }\r\n\r\n  async function crearRol() {\r\n    if (!nombre) {\r\n      alert(\"Debe escribir un nombre para el rol\");\r\n      return;\r\n    }\r\n\r\n    // Validar duplicado de nombre de rol (sin distinguir mayúsculas/minúsculas)\r\n    const resDuplicado = await api.get(\"/roles\");\r\n    const existe = resDuplicado.data.some(\r\n      (r) => r.nombre.toLowerCase() === nombre.toLowerCase()\r\n    );\r\n\r\n    if (existe) {\r\n      alert(\"Ya existe un rol con ese nombre.\");\r\n      return;\r\n    }\r\n\r\n\r\n    // Validar la regla especial: máximo 2 Super Administradores\r\n    if (nombre.toLowerCase() === \"super administrador\") {\r\n      const res = await api.get(\"/roles?nombre=Super Administrador\");\r\n      const existentes = res.data.filter((r) => r.estado === true);\r\n      if (existentes.length >= 2) {\r\n        alert(\"Ya existen 2 Super Administradores activos. No puede crear más.\");\r\n        return;\r\n      }\r\n    }\r\n\r\n    const nuevoRol = {\r\n      nombre: nombre,\r\n      estado: true,\r\n      createdAt: new Date().toISOString(),\r\n      createdBy: \"web\"\r\n    };\r\n\r\n    await api.post(\"/roles\", nuevoRol);\r\n    setNombre(\"\");\r\n    cargarRoles();\r\n  }\r\n\r\n  async function eliminarRol(rol) {\r\n    // eliminación lógica (estado = false)\r\n    await api.patch(`/roles/${rol.id}`, {\r\n      estado: false,\r\n      updatedAt: new Date().toISOString()\r\n    });\r\n    cargarRoles();\r\n    cargarInactivos();\r\n  }\r\n\r\n  async function reactivarRol(rol) {\r\n    await api.patch(`/roles/${rol.id}`, {\r\n      estado: true,\r\n      updatedAt: new Date().toISOString()\r\n    });\r\n    cargarRoles();\r\n    cargarInactivos();\r\n  }\r\n\r\n  return (\r\n    <div style={{ padding: 20 }}>\r\n      <h2>Gestión de Roles</h2>\r\n\r\n      {/* Crear nuevo rol */}\r\n      <div style={{ marginBottom: 20 }}>\r\n        <input\r\n          placeholder=\"Nuevo rol\"\r\n          value={nombre}\r\n          onChange={(e) => setNombre(e.target.value)}\r\n        />\r\n        <button onClick={crearRol}>Crear Rol</button>\r\n      </div>\r\n\r\n      {/* Lista de roles activos */}\r\n      <h3>Roles Activos</h3>\r\n      <ul>\r\n        {roles.map((r) => (\r\n          <li key={r.id}>\r\n            {r.nombre}{\" \"}\r\n            <button onClick={() => eliminarRol(r)}>Eliminar</button>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n\r\n      {/* Lista de roles inactivos */}\r\n      <h3>Roles Inactivos (para reactivar)</h3>\r\n      <ul>\r\n        {inactivos.map((r) => (\r\n          <li key={r.id}>\r\n            {r.nombre}{\" \"}\r\n            <button onClick={() => reactivarRol(r)}>Reactivar</button>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}